<?xml version="1.0"?>

<dbp:module
	xmlns:dbp="http://dbpager.org.ru/schemas/dbp/3.0"
	xmlns:lib="http://dbpager.org.ru/schemas/dbp/3.0/custom"
	xmlns:app="http://dbpager.org.ru/schemas/dbp/3.0/custom"
	xmlns:routes="http://dbpager.org.ru/schemas/dbp/3.0/custom"
>

<dbp:tag name="routes">
	<dbp:var name="fired" value="0">
		<dbp:execute />
		<dbp:switch test="{$fired}">
			<dbp:case match="0">
				<dbp:throw code="404">
					<app:blog-not-found />
				</dbp:throw>
			</dbp:case>
		</dbp:switch>		
	</dbp:var>
</dbp:tag>

<dbp:tag name="map">
	<dbp:switch test="{$path_info = $path}">
		<dbp:case match="1">
			<dbp:switch test="{$http_method = $method}">
				<dbp:case match="1">
					<dbp:execute/>
					<dbp:set name="fired">1</dbp:set>
				</dbp:case>
			</dbp:switch>
		</dbp:case>
	</dbp:switch>
</dbp:tag>

</dbp:module>
